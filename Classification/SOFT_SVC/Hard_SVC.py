import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import minimize
#__________________________________________________________________________________________________________________________________________________

#X=np.array([[1,4,8,9],[2,3,7,11],[-1,-1,1,1]])
np.random.seed(21)
d=np.random.normal(0.5, 0.2, size=(100, 2))
l2=np.random.uniform(0, 1,100)>0.5
# y is in {-1, 1}
l = 2. * l2 - 1
d *= l[:, np.newaxis]
d -= d.mean(axis=0)

#______________________________________________________________________________________________________________________________
fun = lambda w: 0.5*(w[0]**2+w[1]**2)


cons =({'type': 'ineq', 'fun': lambda w:     0.5076121612630413 *w[0]+ 0.5161632052544364 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6903543486526781 *w[0]+ 0.2102497258616813 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6310725251353054 *w[0]+ 0.11938683252914437 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.47683213481929443 *w[0]+ 0.4914881570838757 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.707623797597939 *w[0]+ 0.45907239434911357 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.359354931453212 *w[0]+ 0.736335284626762 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.8402034064518166 *w[0]+ 0.400556761077144 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6563897532943274 *w[0]+ 0.4487792948100502 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5504735045235838 *w[0]+ 0.5898482421509584 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.2629138393039105 *w[0]+ 0.5512033023104514 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.26962366518826775 *w[0]+ 0.2637239059608934 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.39045034363696324 *w[0]+ 0.06476126180620792 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.1867065644367635 *w[0]+ 0.507958176606716 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6108268437244542 *w[0]+ 0.6320221237278766 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.42520126744718767 *w[0]+ 0.6778377348290976 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.8315814464885992 *w[0]+ 0.7741136564971242 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.20520361512030946 *w[0]+ 0.11213082560836299 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5985497694113184 *w[0]+ 0.7872989749176156 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5132377407566184 *w[0]+ 0.7289159569731405 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5669977995691179 *w[0]+ 0.5832218432367267 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5773412506031377 *w[0]+ 0.582553092615973 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.4333448445861998 *w[0]+ 0.9075254380122212 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6660179025970127 *w[0]+ 0.35001433868468806 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.4609600032475394 *w[0]+ 0.3301490882642857 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6140788962707416 *w[0]+ 0.2529268943645107 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.4153417050470399 *w[0]+ 0.6110592832109716 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5940409145094426 *w[0]+ 0.5763393719465584 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.24581888510924335 *w[0]+ 0.6145276013514298 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.49112801448578386 *w[0]+ 0.8033299504748637 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.42670945969166646 *w[0]+ 0.7975077795372709 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6010373859739122 *w[0]+ 0.6879387361154545 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.40348890761680417 *w[0]+ 0.3803327702054911 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.4048257944656871 *w[0]+ 0.6617780200893653 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.42846852474460106 *w[0]+ 0.515185611653613 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.7157979118445847 *w[0]+ 0.5647203753716219 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.4664315650475276 *w[0]+ 0.5954115780719952 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.2370869410408281 *w[0]+ 0.23658594450409873 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5688565677995226 *w[0]+ 1.0125982441149957 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.8841535505051407 *w[0]+ 0.9655772577155917 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6320925263546989 *w[0]+ 0.43309931428428716 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6956396196894433 *w[0]+ 0.2226889108482332 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     -0.08994260834127686 *w[0]+ 0.5464389898190569 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6887175157390798 *w[0]+ 0.6026383001874117 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.8280580158789909 *w[0]+ 0.6914863046846041 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5512567452165654 *w[0]+ 0.2508341236052819 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.49210725789272125 *w[0]+ 0.30211552358229155 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.40822895149837046 *w[0]+ 0.8421455705930276 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5240364337574296 *w[0]+ 0.5369381467480296 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.379217851017881 *w[0]+ 1.0589650710071705 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.12134944549136138 *w[0]+ 0.35302968363695353 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.7071842247800578 *w[0]+ 0.38828558457675166 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.3231429801468729 *w[0]+ 0.5632772497617755 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.631676821363964 *w[0]+ 0.5981244266652962 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.310760925130852 *w[0]+ 0.6122532214204779 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.2760500115993787 *w[0]+ 0.35489596739516915 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.31863999154215283 *w[0]+ 0.6039417964168043 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.44756234324732336 *w[0]+ 0.348042043988545 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5243036998296424 *w[0]+ 0.33371185818641 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.3810225375402142 *w[0]+ 0.3992175611079799 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.40442739367085623 *w[0]+ 0.3371805623088089 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.2684209212943337 *w[0]+ 0.7581203183573014 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.10447941141339039 *w[0]+ 0.5979784775545441 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.32098145626026164 *w[0]+ 0.32003426425134757 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.12538818430009915 *w[0]+ 0.4554876753098062 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.37103469419465146 *w[0]+ 0.6733914055648587 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.3688325671571527 *w[0]+ 0.24362976188578536 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.2417691501887668 *w[0]+ 0.6529601710143034 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.631584658273642 *w[0]+ 0.4685680619205548 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.813767264661078 *w[0]+ 0.5148546908730808 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.4231286585463531 *w[0]+ 0.5651971251698675 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.2617705059146583 *w[0]+ 0.48167170816496985 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.25554394576152195 *w[0]+ 0.5767531969953296 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6445985473213415 *w[0]+ 0.516535315180919 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.7333507775516462 *w[0]+ 0.3978086784003292 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5897509843548209 *w[0]+ 0.4366977330585235 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.2510222499268465 *w[0]+ 0.5991801268082592 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.8576803696057367 *w[0]+ 1.1572987249408615 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5364866042397066 *w[0]+ 0.6345617129076918 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.8237622205326195 *w[0]+ 0.25166595149997323 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.7853219422891579 *w[0]+ 0.1294749494222137 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.25086409900930706 *w[0]+ 0.4167691332227137 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.44123166270289477 *w[0]+ 0.7318808164756364 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.2684027072802595 *w[0]+ 0.4362850392038713 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.41219564018420485 *w[0]+ 0.4941684788567028 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.6047209974704818 *w[0]+ 0.6481733284518527 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5462116794271269 *w[0]+ 0.5382475912349901 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.49200479709084 *w[0]+ 0.14918133680674625 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.11668366099003748 *w[0]+ 0.5334399772423828 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.20448406658729404 *w[0]+ 0.30361527742047145 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5617564924096221 *w[0]+ 0.46811047850892296 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.32220889508243644 *w[0]+ 0.28093440687849647 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5254861030344822 *w[0]+ 0.8318943283418851 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.14243998532210553 *w[0]+ 0.41245978955257173 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.7103220045723275 *w[0]+ 0.5911520923559284 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.36235977145935494 *w[0]+ 0.46805845640910637 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5637775744963701 *w[0]+ 0.6648047476696456 *w[1]+ -1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.1983430153297637 *w[0]+ 0.3661144850198252 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.573271854146875 *w[0]+ 0.6250755037946085 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.5668000212551139 *w[0]+ 0.620682077834861 *w[1]+ 1.0 *w[2] -1 },
{'type': 'ineq', 'fun': lambda w:     0.694560400576332 *w[0]+ 0.6302201521498809 *w[1]+ 1.0 *w[2] -1 })

bnds = ((None, None), (None, None),(None, None))

res = minimize(fun, np.array([1, 1,1]), method='SLSQP',jac='2-point', bounds=bnds,constraints=cons)



w = res.x
print("w* = ",w)


x1 = np.arange(-1,2)
x2 = (-w[1]*x1-w[2])/w[0]
x3 = np.arange(-1,2)
x4 = (-w[1]*x3-w[2]-1)/w[0]
x5 = np.arange(-1,2)
x6 = (-w[1]*x5-w[2]+1)/w[0]
#plt.scatter(X[0],X[1], c = X[2], s = 100)
a=d[:,0]
b=d[:,1]
plt.scatter(a, b, c =l, s = 100)

plt.xlabel("x1")
plt.ylabel("x2")
plt.title('Perceptron\'s world')
plt.grid(linestyle = '--',c = 'blue')
plt.plot(x1, x2,c = 'green')
plt.plot(x3, x4,c = 'red')
plt.plot(x5, x6,c = 'red')
plt.show()
plt.pause(20)


